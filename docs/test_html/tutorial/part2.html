<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#2D2D2D" />
  
  <title>portfolyo :: Tutorial part 2</title>
  

  <link rel="icon" type="image/png" sizes="32x32" href="../_static/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../_static/img/favicon-16x16.png">
  <link rel="index" title="Index" href="../genindex.html"/>

  <link rel="stylesheet" href="../_static/css/insegel.css"/>
  <link rel="stylesheet" href="../_static/css/custom.css"/>

  <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/sphinx_highlight.js"></script>
      <script type="text/javascript" src="../https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script type="text/javascript" src="../"></script>
      <script type="text/javascript" src="../https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  

  <script src="https://email.tl.fortawesome.com/c/eJxNjUEOgyAQAF8jR7Kw6wIHDh7sP1Cw2mgxgmn6-3JsMqc5zEQfE8dkxOY1KKMUOI3ACFKRJpSW2AAp7ontYIaxI6i7XPJVwyeVfCQ550Os3jLrGSNOLgbdAy6s0PBk2TFNjEbsfq31LB0OnX407pJa5v2faRadwSW63mn5KuLyR9j2tgx3zecanl-55R_-jjPs"></script> 
</head>

<body>
  <div id="insegel-container">
    <header>
      <div id="logo-container">
          
          <h1>portfolyo</h1>
          
      </div>
      <div id="project-container">
        
        <h1>Documentation</h1>
        
      </div>
    </header>

    <div id="content-container">

      <div id="main-content-container">
        <div id="main-content" role="main">
          
  <section id="Tutorial-part-2">
<h1>Tutorial part 2<a class="headerlink" href="#Tutorial-part-2" title="Link to this heading">¶</a></h1>
<p>Here we’ll continue learning about the <code class="docutils literal notranslate"><span class="pre">PfLine</span></code> class.</p>
<p>In <a class="reference internal" href="part1.html"><span class="doc">part 1</span></a> we saw ‘flat’ portfolio lines, i.e., portfolio lines without nested children. These portfolio lines have a single value for each timestamp for each dimension (i.e., for a price-and-volume portfolio line: one price value, one power value, one energy value, one revenue value).</p>
<p>We’ll look at nested portfolio lines in this part of the tutorial.</p>
<section id="Example-data">
<h2>Example data<a class="headerlink" href="#Example-data" title="Link to this heading">¶</a></h2>
<p>Let’s first use the mock functions to get some timeseries and (flat) portfolio lines:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">portfolyo</span> <span class="k">as</span> <span class="nn">pf</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2024&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">366</span><span class="p">)</span>
<span class="c1"># Creating some distinct timeseries (the details here are not important).</span>
<span class="n">ts_offtake_B2C</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">pf</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">w_offtake</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">avg</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">year_amp</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">week_amp</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ts_offtake_B2B</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">pf</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">w_offtake</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">avg</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">year_amp</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">week_amp</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="c1"># turning these timeseries into portfolio lines.</span>
<span class="n">offtake_B2C</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">PfLine</span><span class="p">({</span><span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">ts_offtake_B2C</span><span class="p">})</span>
<span class="n">offtake_B2B</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">PfLine</span><span class="p">({</span><span class="s2">&quot;w&quot;</span><span class="p">:</span> <span class="n">ts_offtake_B2B</span><span class="p">})</span>
</pre></div>
</div>
</div>
<p>We already saw that we can do arithmatic with portfolio lines, and by adding them together we can get the total offtake portfolio line:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">offtake_B2C</span> <span class="o">+</span> <span class="n">offtake_B2B</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PfLine object with volume information.
. Start: 2024-01-01 00:00:00 (incl)    . Timezone    : none
. End  : 2025-01-01 00:00:00 (excl)    . Start-of-day: 00:00:00
. Freq : &lt;Day&gt; (366 datapoints)
                                     w           q
                                    MW         MWh

2024-01-01 00:00:00             -174.8      -4 196
2024-01-02 00:00:00             -196.4      -4 714
2024-01-03 00:00:00             -192.4      -4 619
2024-01-04 00:00:00             -195.6      -4 696
2024-01-05 00:00:00             -196.0      -4 703
2024-01-06 00:00:00             -176.2      -4 229
2024-01-07 00:00:00             -141.5      -3 396
2024-01-08 00:00:00             -174.6      -4 191
2024-01-09 00:00:00             -194.9      -4 678
2024-01-10 00:00:00             -193.6      -4 647
..                                  ..          ..
2024-12-23 00:00:00             -172.0      -4 128
2024-12-24 00:00:00             -193.8      -4 650
2024-12-25 00:00:00             -193.9      -4 654
2024-12-26 00:00:00             -192.7      -4 626
2024-12-27 00:00:00             -194.5      -4 667
2024-12-28 00:00:00             -176.0      -4 224
2024-12-29 00:00:00             -142.1      -3 410
2024-12-30 00:00:00             -172.3      -4 135
2024-12-31 00:00:00             -196.1      -4 707
</pre></div></div>
</div>
<p>This is again a flat, childless portfolio line; the contributions of the individual portfolios are lost. Often, this is exactly what we want.</p>
</section>
<section id="Portfolio-line-with-children">
<h2>Portfolio line with children<a class="headerlink" href="#Portfolio-line-with-children" title="Link to this heading">¶</a></h2>
<p>In some circumstances, however, we might want to retain the individual data. This is possible: we can combine these two flat volume-only portfolio lines into a new volume-only portfolio line, by specifying in a dictionary that uses their names as keys. Like so:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">offtake</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">PfLine</span><span class="p">({</span><span class="s2">&quot;B2C&quot;</span><span class="p">:</span> <span class="n">offtake_B2C</span><span class="p">,</span> <span class="s2">&quot;B2B&quot;</span><span class="p">:</span> <span class="n">offtake_B2B</span><span class="p">})</span>
<span class="n">offtake</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PfLine object with volume information.
. Start: 2024-01-01 00:00:00 (incl)    . Timezone    : none
. End  : 2025-01-01 00:00:00 (excl)    . Start-of-day: 00:00:00
. Freq : &lt;Day&gt; (366 datapoints)
. Children: &#39;B2C&#39; (volume), &#39;B2B&#39; (volume)
                                     w           q
                                    MW         MWh

2024-01-01 00:00:00             -174.8      -4 196
2024-01-02 00:00:00             -196.4      -4 714
2024-01-03 00:00:00             -192.4      -4 619
2024-01-04 00:00:00             -195.6      -4 696
2024-01-05 00:00:00             -196.0      -4 703
2024-01-06 00:00:00             -176.2      -4 229
2024-01-07 00:00:00             -141.5      -3 396
2024-01-08 00:00:00             -174.6      -4 191
2024-01-09 00:00:00             -194.9      -4 678
2024-01-10 00:00:00             -193.6      -4 647
..                                  ..          ..
2024-12-23 00:00:00             -172.0      -4 128
2024-12-24 00:00:00             -193.8      -4 650
2024-12-25 00:00:00             -193.9      -4 654
2024-12-26 00:00:00             -192.7      -4 626
2024-12-27 00:00:00             -194.5      -4 667
2024-12-28 00:00:00             -176.0      -4 224
2024-12-29 00:00:00             -142.1      -3 410
2024-12-30 00:00:00             -172.3      -4 135
2024-12-31 00:00:00             -196.1      -4 707
</pre></div></div>
</div>
<p>Superficially, this is the exact same object as the one before it. And unless we specify that we are interested in one of the children, we are working with the exact same aggregate data.</p>
<section id="Accessing-the-children">
<h3>Accessing the children<a class="headerlink" href="#Accessing-the-children" title="Link to this heading">¶</a></h3>
<p>However, as can be seen in the header, this portfolio line has children, which have the names we specified for them: <code class="docutils literal notranslate"><span class="pre">&quot;B2C&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;B2B&quot;</span></code>. If we want, we can access these by using their names as an index, e.g.:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">offtake</span><span class="p">[</span><span class="s2">&quot;B2C&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PfLine object with volume information.
. Start: 2024-01-01 00:00:00 (incl)    . Timezone    : none
. End  : 2025-01-01 00:00:00 (excl)    . Start-of-day: 00:00:00
. Freq : &lt;Day&gt; (366 datapoints)
                                     w           q
                                    MW         MWh

2024-01-01 00:00:00             -125.2      -3 005
2024-01-02 00:00:00             -145.0      -3 479
2024-01-03 00:00:00             -141.3      -3 391
2024-01-04 00:00:00             -143.6      -3 447
2024-01-05 00:00:00             -144.3      -3 464
2024-01-06 00:00:00             -125.6      -3 014
2024-01-07 00:00:00              -93.8      -2 251
2024-01-08 00:00:00             -123.9      -2 974
2024-01-09 00:00:00             -143.6      -3 447
2024-01-10 00:00:00             -141.7      -3 401
..                                  ..          ..
2024-12-23 00:00:00             -121.5      -2 916
2024-12-24 00:00:00             -142.5      -3 421
2024-12-25 00:00:00             -141.5      -3 395
2024-12-26 00:00:00             -142.0      -3 409
2024-12-27 00:00:00             -142.2      -3 412
2024-12-28 00:00:00             -125.4      -3 009
2024-12-29 00:00:00              -95.7      -2 296
2024-12-30 00:00:00             -122.8      -2 947
2024-12-31 00:00:00             -143.4      -3 442
</pre></div></div>
</div>
<p>Nesting like this is not limited to one level.</p>
</section>
</section>
<section id="Arithmatic-with-children">
<h2>Arithmatic with children<a class="headerlink" href="#Arithmatic-with-children" title="Link to this heading">¶</a></h2>
<p>All of the arithmatic operations that we can do with flat portfolio lines, we can also do with portfolio lines that have children.</p>
<p>In some operations, the children can be retained (i.e., are present in the resulting portfolio line). In some, however, they cannot, and the portfolio line is flattened. In that case, a <code class="docutils literal notranslate"><span class="pre">PfLineFlattenedWarning</span></code> is issued:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_offtake</span> <span class="o">=</span> <span class="n">offtake</span> <span class="o">-</span> <span class="n">pf</span><span class="o">.</span><span class="n">Q_</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="s2">&quot;MWh&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\users\ruud.wijtvliet\ruud\python\dev\portfolyo\portfolyo\core\pfline\enable_arithmatic.py:82: PfLineFlattenedWarning: When adding a FlatPfLine and NestedPfLine, the NestedPfLine is flattened.
  warnings.warn(
</pre></div></div>
</div>
<p>See the section on arithmatic for more details on when a portfolio line’s children are retained and when not.</p>
<p>This tutorial is continued <a class="reference internal" href="part3.html"><span class="doc">in part 3</span></a>.</p>
</section>
</section>


        </div>
      </div>

      <div id="side-menu-container">

        <div id="search" role="search">
        <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
            <input type="text" name="q" placeholder="Search..." />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
        </form>
</div>

        <div id="side-menu" role="navigation">

          
  
    
  
  
    <p class="caption" role="heading"><span class="caption-text">Core functionality</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core/objects.html">Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/pfline.html">PfLine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/pfstate.html">PfState</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/interoperability.html">Interoperability</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="part1.html">Tutorial part 1</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="part3.html">Tutorial part 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="part4.html">Tutorial part 4</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Specialized topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../specialized_topics/dataprep.html">Preprocessing input data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../specialized_topics/timezones.html">Timezones</a></li>
<li class="toctree-l1"><a class="reference internal" href="../specialized_topics/dimensions.html">Dimensions and Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../specialized_topics/indices.html">Indices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../specialized_topics/resampling.html">Resampling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Full reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../full_reference.html">Full reference</a></li>
</ul>

  


        </div>

        

      </div>

    </div>

<footer>
    <div id="footer-info">
        <ul id="build-details">
            
                <li class="footer-element">
                    
                        <a href="../_sources/tutorial/part2.ipynb.txt" rel="nofollow"> source</a>
                    
                </li>
            

            

            
        </ul>

        
            <div id="copyright">
                &copy; Ruud Wijtvliet
            </div>
        

        <div id="credit">
            created with <a href="http://sphinx-doc.org/">Sphinx</a> and <a href="https://github.com/Autophagy/insegel">Insegel</a>

        </div>
    </div>

    <a id="menu-toggle" class="fa fa-bars" aria-hidden="true"></a>

    <script type="text/javascript">
      $("#menu-toggle").click(function() {
        $("#menu-toggle").toggleClass("toggled");
        $("#side-menu-container").slideToggle(300);
      });
    </script>

</footer> 

</div>

</body>
</html>